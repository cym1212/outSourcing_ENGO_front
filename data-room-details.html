<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>한국 환경협회</title>
    <link rel="apple-touch-icon" sizes="180x180" href="assets/images/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/images/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/images/favicons/favicon-16x16.png">
    <link rel="manifest" href="assets/images/favicons/site.webmanifest">

    <!-- Fonts-->

    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/moonspam/NanumSquare@2.0/nanumsquare.css">
    <!-- Css-->
    <link rel="stylesheet" href="assets/css/animate.min.css">
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/owl.carousel.min.css">
    <link rel="stylesheet" href="assets/css/owl.theme.default.min.css">
    <link rel="stylesheet" href="assets/css/magnific-popup.css">
    <link rel="stylesheet" href="assets/css/fontawesome-all.min.css">
    <link rel="stylesheet" href="assets/css/swiper.min.css">
    <link rel="stylesheet" href="assets/css/bootstrap-select.min.css">

    <link rel="stylesheet" href="assets/css/jquery.mCustomScrollbar.min.css">
    <link rel="stylesheet" href="assets/css/bootstrap-datepicker.min.css">
    <link rel="stylesheet" href="assets/css/vegas.min.css">
    <link rel="stylesheet" href="assets/css/nouislider.min.css">
    <link rel="stylesheet" href="assets/css/nouislider.pips.css">
    <link rel="stylesheet" href="assets/css/jquery.bxslider.css">
    <link rel="stylesheet" href="assets/css/agrikol_iconl.css">
    <!-- Template styles -->
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/responsive.css">

</head>

<body>

<div class="preloader">
    <img src="assets/images/loader.png" class="preloader__image" alt="">
</div><!-- /.preloader -->

<div class="page-wrapper">


    <div class="site-header__header-one-wrap">

        <div class="topbar-one">
            <div class="topbar_bg" style="background-image: url(assets/images/shapes/header-bg.png)"></div>
            <div class="container">
                <div class="topbar-one__left">
                    <a href="tel:010-5850-8885"><span class="icon-phone-call"></span>010-5850-8885</a>
                    <a href="mailto:gislmh@naver.com"><span class="icon-message"></span>gislmh@naver.com</a>
                    <a ><span class="icon-clock"></span>9AM - 6PM</a>
                </div>

<!--                <div class="topbar-one__right">-->
<!--                    <div class="topbar-one__social">-->
<!--                        <a href="#"><i class="fab fa-facebook-square"></i></a>-->
<!--                        <a href="#"><i class="fab fa-twitter"></i></a>-->
<!--                        <a href="#"><i class="fab fa-youtube"></i></a>-->
<!--                        <a href="#"><i class="fab fa-instagram"></i></a>-->
<!--                    </div>-->
<!--                </div>-->
            </div>
        </div>

        <header class="main-nav__header-one">
            <nav class="header-navigation stricky">
                <div class="container clearfix">
                    <!-- Brand and toggle get grouped for better mobile display -->
                     <div class="main-nav__left1">
                        <a href="#" class="side-menu__toggler">
                            <i class="fa fa-bars"></i>
                        </a>
                    </div>
                    <div class="main-nav__left">
                        <a href="index.html" class="main-nav__logo">
                            <img src="assets/images/resources/main-logo2.png" class="main-logo" alt="Awesome Image"/>
                        </a>

                    </div>
                    <div class="main-nav__main-navigation">
                        <ul class=" main-nav__navigation-box">
                            <li class="dropdown">
                                <a href="greeting.html">협회 소개</a>
                                <ul>
                                    <li><a href="greeting.html">인사말</a></li>
                                    <li><a href="license.html">설립허가 및 고유번호증</a></li>
                                    <li><a href="organization-chart.html">조직도</a></li>
                                    <li><a href="vision.html">협회비전</a></li>
                                    <li><a href="ci.html">협회 CI</a></li>

                                </ul><!-- /.sub-menu -->
                            </li>
                            <li class="dropdown">
                                <a href="environmental-program.html">협회 사업</a>
                                <ul>
                                    <li><a href="environmental-education.html">환경 교육 프로그램</a></li>
                                    <li><a href="environmental-program.html">환경 체험 프로그램</a></li>
                                    <li><a href="nature-restoration-project.html">풀빛 세상 만들기</a></li>
                                    <li><a href="csr-consulting.html">기업 사회 공헌 컨설팅</a></li>
                                </ul><!-- /.sub-menu -->
                            </li>
                            <li class="dropdown">
                                <a href="notice.html">커뮤니티</a>
                                <ul>
                                    <li><a href="notice.html">공지사항</a></li>
                                    <li><a href="free-board.html">자유게시판</a></li>
                                    <li><a href="gallery.html">사진갤러리</a></li>
                                </ul><!-- /.sub-menu -->
                            </li>
                            <li class="dropdown current">
                                <a href="data-room.html">자료실</a>
                                <ul>
                                    <li><a href="data-room.html">협회 자료</a></li>
                                </ul><!-- /.sub-menu -->
                            </li>
                            <li class="dropdown">
                                <a href="donation.html">후원 안내</a>
                                <ul>
                                    <li><a href="donation.html">후원신청</a></li>
                                </ul><!-- /.sub-menu -->
                            </li>
                            <li class="dropdown" id="loginMenu">
                                <a href="login.html">로그인</a>
                                <ul>
                                    <li><a href="sign-up.html">회원 가입</a></li>
                                </ul>
                            </li>

                        </ul>
                    </div><!-- /.navbar-collapse -->

                    <div class="main-nav__right">

                    </div>
                </div>
            </nav>
        </header>
    </div>

    <section class="page-header" style="background-image: url(assets/images/resources/image3.jpg);">
        <div class="container">
            <p>21세기 친환경 한국을 향한 꿈</p>
            <h2>커뮤니티</h2>

        </div>
    </section>

    <section class="view-notice4">
        <div class="container">
            <h2 id="introduction">협회 자료</h2>
            <h2 id="view-title4">상세보기</h2>

            <table id="notice-details4">
                <tr>
                    <th>번호</th>
                    <td>12</td>
                    <th>작성일</th>
                    <td>2022-09-16</td>
                </tr>
                <tr>
                    <th>이름</th>
                    <td>홍길동</td>
                    <th>조회수</th>
                    <td>1</td>
                </tr>
                <tr>
                    <th>제목</th>
                    <td colspan="3">상세보기 제목입니다.</td>
                </tr>
                <tr>
                    <td colspan="4" class="content">
                        작성입니다~
                    </td>
                </tr>
            </table>

            <div class="notice-footer4">
                <a href="data-room-edit.html" id="edit-notice4" style="display: block;">수정</a>
                <a href="" id="delete-notice4" style="display: block;">삭제</a>
                <a href="data-room.html" id="back-notice4">목록</a>
                <a href="" id="recommand-notice">추천하기</a>
            </div>

            <!-- 댓글 섹션 시작 -->
            <div class="comments-section4">
                <h3>댓글</h3>

                <!-- 댓글 목록 -->
                <div class="comment4">
                    <div class="comment-header4">
                        <span class="comment-author4">작성자 : 김철수</span>
                        <span class="comment-time4">2024-10-11 14:30</span>
                    </div>
                    <p class="comment-content4">이 글 정말 유익하네요!</p>
                </div>

                <div class="comment4">
                    <div class="comment-header4">
                        <span class="comment-author4">작성자 : 이영희</span>
                        <span class="comment-time4">2024-10-10 16:15</span>
                    </div>
                    <p class="comment-content4">잘 읽고 갑니다.</p>
                </div>

                <!-- 새로운 댓글 작성 -->
                <div class="comment-form4">
                    <h4>댓글 작성하기</h4>
                    <textarea id="new-comment4" placeholder="댓글을 입력하세요"></textarea>
                    <input type="text" id="new-author4" placeholder="작성자 이름" />
                    <!-- 버튼을 감싸는 div 추가 -->
                    <div class="button-container4">
                        <button id="submit-comment4">댓글 작성</button>
                    </div>
                </div>
            </div>
        </div>
    </section>


    <div class="site-footer_bottom">
        <div class="container">
            <div class="site-footer_bottom_copyright">
                <p> <a href="donation.html">@ 한국 환경협회</a></p>
            </div>
            <div class="site-footer_bottom_copyright">
                <p> 고유번호 : 497-82-00350  </p>
            </div>
        </div>
    </div>


</div><!-- /.page-wrapper -->


<a href="#" data-target="html" class="scroll-to-target scroll-to-top"><i class="fa fa-angle-up"></i></a>

<div class="side-menu__block">
    <div class="side-menu__block-overlay custom-cursor__overlay">
        <div class="cursor"></div>
        <div class="cursor-follower"></div>
    </div><!-- /.side-menu__block-overlay -->
    <div class="side-menu__block-inner ">
        <div class="side-menu__top justify-content-end">
            <a href="#" class="side-menu__toggler side-menu__close-btn"><img
                    src="assets/images/shapes/close-1-1.png" alt=""></a>
        </div><!-- /.side-menu__top -->

        <nav class="mobile-nav__container">
            <!-- content is loading via js -->
        </nav>

        <div class="side-menu__sep"></div><!-- /.side-menu__sep -->

        <div class="side-menu__content">
            <p><a href="mailto:gislmh@naver.com">gislmh@naver.com</a> <br> <a href="tel:010-5850-8885">010-5850-8885</a></p>
            <!--            <div class="side-menu__social">-->
            <!--                <a href="#"><i class="fab fa-facebook-square"></i></a>-->
            <!--                <a href="#"><i class="fab fa-twitter"></i></a>-->
            <!--                <a href="#"><i class="fab fa-instagram"></i></a>-->
            <!--                <a href="#"><i class="fab fa-pinterest-p"></i></a>-->
            <!--            </div>-->
        </div>
    </div>
</div>


<script src="assets/js/jquery.min.js"></script>
<script src="assets/js/bootstrap.bundle.min.js"></script>
<script src="assets/js/owl.carousel.min.js"></script>
<script src="assets/js/waypoints.min.js"></script>
<script src="assets/js/jquery.counterup.min.js"></script>
<script src="assets/js/TweenMax.min.js"></script>
<script src="assets/js/wow.js"></script>
<script src="assets/js/jquery.magnific-popup.min.js"></script>
<script src="assets/js/jquery.ajaxchimp.min.js"></script>
<script src="assets/js/swiper.min.js"></script>
<script src="assets/js/typed-2.0.11.js"></script>
<script src="assets/js/vegas.min.js"></script>
<script src="assets/js/jquery.validate.min.js"></script>
<script src="assets/js/bootstrap-select.min.js"></script>
<script src="assets/js/countdown.min.js"></script>
<script src="assets/js/jquery.mCustomScrollbar.concat.min.js"></script>
<script src="assets/js/bootstrap-datepicker.min.js"></script>
<script src="assets/js/nouislider.min.js"></script>
<script src="assets/js/isotope.js"></script>
<script src="assets/js/jquery.bxslider.min.js"></script>
<script src="assets/js/appear.js"></script>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

<!-- template scripts -->
<script src="assets/js/theme.js"></script>
<script src="assets/js/tokenManager.js"></script>
<script src="assets/js/logoutHandler.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const postId = localStorage.getItem('currentPostId');
        const detailsTable = document.getElementById('notice-details4');
        const commentsSection = document.querySelector('.comments-section4');

        if (postId) {
            fetchBoardDetails();
            fetchComments();
        } else{
            swal({
                title: "경고!",
                text: "게시글 ID가 없습니다. 게시글 목록으로 돌아갑니다. " ,
                icon: "error",
                buttons: {
                            confirm: {
                                text: "확인",
                                value: true,
                                visible: true,
                                className: "custom-confirm-btn",
                                closeModal: true
                            }
                        }
            }).then(() => {
                window.location.href = 'data-room.html';
            });
            return;
        }

        // 게시글 상세 조회 함수
        function fetchBoardDetails() {
            fetchWithAuth(`http://49.247.174.32:8080/third-board/${postId}`)
            // fetchWithAuth(`http://localhost:8080/third-board/${postId}`)
                .then(response => response.json())
                .then(data => {
                    localStorage.setItem('requestUserId', data.requestUserId);
                    localStorage.setItem('requestUserRole', data.requestUserRole);
                    displayBoardDetails(data);
                })
                .catch(error => {
                    swal({
                        title: "실패!",
                        text: "게시글을 불러오는 중 오류가 발생했습니다 :" + error.message ,
                        icon: "error",
                        buttons: {
                            confirm: {
                                text: "확인",
                                value: true,
                                visible: true,
                                className: "custom-confirm-btn",
                                closeModal: true
                            }
                        }
                    });
                });
        }

        // 게시글 상세 정보를 화면에 출력하는 함수
        function displayBoardDetails(data) {
            const requestId = data.requestUserId;
            const userRole = data.requestUserRole;
            detailsTable.innerHTML = `
            <tr>
                <th>이름</th><td>${data.name}</td>
                <th>작성일</th><td>${new Date(data.createdAt).toLocaleDateString()}</td>
            </tr>
            <tr>
                <th>추천수</th><td>${data.likeCount}</td>
                <th>조회수</th><td>${data.viewCount}</td>
            </tr>
            <tr>
                <th>제목</th><td colspan="3">${data.title}</td>
            </tr>
            <tr>
                <td colspan="4" class="content">${data.content}</td>
            </tr>
        `;

            const editButton = document.getElementById('edit-notice4');
            const deleteButton = document.getElementById('delete-notice4');

            if (requestId !== 0 && (requestId === data.authorId || userRole === 'ADMIN')) {
                // 작성자이거나 관리자일 경우 버튼 표시
                editButton.style.display = 'inline-block';
                deleteButton.style.display = 'inline-block';
            } else {
                // 그렇지 않은 경우 버튼 숨기기
                editButton.style.display = 'none';
                deleteButton.style.display = 'none';
            }
        }


        let isLiked = false;

        document.getElementById('recommand-notice').addEventListener('click', function (e) {
            e.preventDefault();
            if (!getAccessToken()) {
                swal({
                    title: "경고!",
                    text: "로그인이 필요합니다." ,
                    icon: "error",
                    buttons: {
                            confirm: {
                                text: "확인",
                                value: true,
                                visible: true,
                                className: "custom-confirm-btn",
                                closeModal: true
                            }
                        }
                }).then(() => {
                    window.location.href = 'login.html'
                });

                return;
            }

            if (isLiked) {
                fetchWithAuth(`http://49.247.174.32:8080/third-board/${postId}/unlike`, {
                // fetchWithAuth(`http://localhost:8080/third-board/${postId}/unlike`, {
                    method: 'POST'
                })
                    .then(response => {
                        if (response.ok) {
                            isLiked = false;
                            fetchBoardDetails();
                            swal({
                                title: "성공!",
                                text: "추천이 취소되었습니다." ,
                                icon: "success",
                                buttons: {
                            confirm: {
                                text: "확인",
                                value: true,
                                visible: true,
                                className: "custom-confirm-btn",
                                closeModal: true
                            }
                        }
                            });
                        } else {
                            swal({
                                title: "실패!",
                                text: "추천 취소 중 오류가 발생했습니다." ,
                                icon: "error",
                                buttons: {
                            confirm: {
                                text: "확인",
                                value: true,
                                visible: true,
                                className: "custom-confirm-btn",
                                closeModal: true
                            }
                        }
                            });
                        }
                    })
                    .catch(error => {
                        swal({
                            title: "실패!",
                            text: "추천 취소 중 오류가 발생했습니다 :" +error.message ,
                            icon: "error",
                            buttons: {
                            confirm: {
                                text: "확인",
                                value: true,
                                visible: true,
                                className: "custom-confirm-btn",
                                closeModal: true
                            }
                        }
                        });
                    });
            } else {

                fetchWithAuth(`http://49.247.174.32:8080/third-board/${postId}/like`, {
                // fetchWithAuth(`http://localhost:8080/third-board/${postId}/like`, {
                    method: 'POST'
                })
                    .then(response => {
                        if (response.ok) {
                            isLiked = true;
                            fetchBoardDetails();
                            swal({
                                title: "성공!",
                                text: "추천되었습니다." ,
                                icon: "success",
                                buttons: {
                            confirm: {
                                text: "확인",
                                value: true,
                                visible: true,
                                className: "custom-confirm-btn",
                                closeModal: true
                            }
                        }
                            });
                        } else {
                            swal({
                                title: "실패!",
                                text: "추천 취소 중 오류가 발생했습니다." ,
                                icon: "error",
                                buttons: {
                            confirm: {
                                text: "확인",
                                value: true,
                                visible: true,
                                className: "custom-confirm-btn",
                                closeModal: true
                            }
                        }
                            });
                        }
                    })
                    .catch(error => {
                        swal({
                            title: "실패!",
                            text: "추천 취소 중 오류가 발생했습니다 :" + error.message,
                            icon: "error",
                            buttons: {
                            confirm: {
                                text: "확인",
                                value: true,
                                visible: true,
                                className: "custom-confirm-btn",
                                closeModal: true
                            }
                        }
                        });
                    });
            }
        });

        document.getElementById('delete-notice4').addEventListener('click', function (e) {
            e.preventDefault();

            swal({
                title: "게시글 삭제",
                text: "정말로 이 게시글을 삭제하시겠습니까?",
                icon: "warning",
                buttons: ["취소", "삭제"],
                dangerMode: true,
            })
                .then((willDelete) => {
                    if (willDelete) {
                        fetchWithAuth(`http://49.247.174.32:8080/third-board/${postId}`, {
                        // fetchWithAuth(`http://localhost:8080/third-board/${postId}`, {
                            method: 'DELETE'
                        })
                            .then(response => {
                                if (response.ok) {
                                    swal({
                                        title: "성공!",
                                        text: "게시글이 삭제되었습니다.",
                                        icon: "success",
                                        buttons: {
                            confirm: {
                                text: "확인",
                                value: true,
                                visible: true,
                                className: "custom-confirm-btn",
                                closeModal: true
                            }
                        }
                                    }).then(() => {
                                        window.location.href = 'data-room.html';
                                    });

                                } else {
                                    swal({
                                        title: "경고!",
                                        text: "삭제할 권한이 없습니다.",
                                        icon: "warning",
                                        buttons: {
                            confirm: {
                                text: "확인",
                                value: true,
                                visible: true,
                                className: "custom-confirm-btn",
                                closeModal: true
                            }
                        }
                                    });
                                }
                            })
                            .catch(error => {
                                swal({
                                    title: "실패!",
                                    text: "게시글 삭제 중 오류가 발생했습니다 :" + error.message,
                                    icon: "error",
                                    buttons: {
                            confirm: {
                                text: "확인",
                                value: true,
                                visible: true,
                                className: "custom-confirm-btn",
                                closeModal: true
                            }
                        }
                                });
                            });
                    }
                });
        });


        // 댓글 조회 함수
        function fetchComments() {
            fetch(`http://49.247.174.32:8080/third-board/${postId}/third-board-comments`)
            // fetch(`http://localhost:8080/third-board/${postId}/third-board-comments`)
                .then(response => response.json())
                .then(data => {
                    displayComments(data.content);
                })
                .catch(error => {
                    swal({
                        title: "실패!",
                        text: "댓글을 불러오던 중 오류가 발생했습니다 :" +error.message ,
                        icon: "error",
                        buttons: {
                            confirm: {
                                text: "확인",
                                value: true,
                                visible: true,
                                className: "custom-confirm-btn",
                                closeModal: true
                            }
                        }
                    });
                });
        }

        // 댓글 목록을 화면에 출력하는 함수
        function displayComments(comments) {
            commentsSection.innerHTML = '';
            const requestId = localStorage.getItem('requestUserId');
            const userRole = localStorage.getItem('requestUserRole');

            // 댓글이 있는 경우 목록 출력
            comments.forEach(comment => {
                const commentElement = document.createElement('div');
                commentElement.classList.add('comment4');
                commentElement.setAttribute('data-comment-id', comment.id);
                if (comment.deleted ===true) {
                    commentElement.innerHTML = `
                <div class="comment-header4">
                    <span class="comment-author4">작성자 : ${comment.memberName}</span>
                    <span class="comment-time4">${new Date(comment.modifiedAt).toLocaleString()}</span>
                </div>
                <p class="comment-content4"><i>이 댓글은 삭제되었습니다.</i></p>
            `;
                } else {
                    // 댓글이 삭제되지 않은 경우 수정 및 삭제 버튼 포함
                    commentElement.innerHTML = `
                <div class="comment-header4">
                    <span class="comment-author4">작성자 : ${comment.memberName}</span>
                    <span class="comment-time4">${new Date(comment.modifiedAt).toLocaleString()}</span>
                </div>
                <p class="comment-content4">${comment.comments}</p>
                <div class="button-group4">
                <button class="edit-comment4" style="display: none;" data-comment-id="${comment.id}">수정</button>
                <button class="delete-comment4" style="display: none;" data-comment-id="${comment.id}">삭제</button>
</div>

            `;

                    // 수정 및 삭제 버튼을 표시할지 여부 결정
                    if (requestId !== '0' && (requestId == comment.authorId || userRole === 'ADMIN')) {
                        const editButton = commentElement.querySelector('.edit-comment4');
                        const deleteButton = commentElement.querySelector('.delete-comment4');
                        editButton.style.display = 'inline-block';
                        deleteButton.style.display = 'inline-block';
                    }
                }
                commentsSection.appendChild(commentElement);
            });

            // 댓글이 없을 경우 안내 메시지 표시
            if (comments.length === 0) {
                const noCommentsElement = document.createElement('p');
                noCommentsElement.textContent = '댓글이 없습니다.';
                commentsSection.appendChild(noCommentsElement);
            }

            // 댓글 작성 폼 추가
            const commentFormElement = document.createElement('div');
            commentFormElement.classList.add('comment-form4');
            commentFormElement.innerHTML = `
        <h4>댓글 작성하기</h4>
        <textarea id="new-comment4" placeholder="댓글을 입력하세요"></textarea>
        <div class="button-container4">
            <button id="submit-comment4">댓글 작성</button>
        </div>
    `;
            commentsSection.appendChild(commentFormElement);

            // 댓글 작성 이벤트 처리
            document.getElementById('submit-comment4').addEventListener('click', submitComment);

            // 댓글 수정 버튼 클릭 이벤트 처리
            document.querySelectorAll('.edit-comment4').forEach(button => {
                button.addEventListener('click', function () {
                    const commentId = this.getAttribute('data-comment-id');
                    editComment(commentId);
                });
            });

            // 댓글 삭제 버튼 클릭 이벤트 처리
            document.querySelectorAll('.delete-comment4').forEach(button => {
                button.addEventListener('click', function () {
                    const commentId = this.getAttribute('data-comment-id');
                    deleteComment(commentId);
                });
            });
        }

        // 댓글 작성 함수
        function submitComment() {
            const commentText = document.getElementById('new-comment4').value;

            if (!getAccessToken()) {
                swal({
                    title: "경고!",
                    text: "로그인이 필요합니다." ,
                    icon: "error",
                    buttons: {
                            confirm: {
                                text: "확인",
                                value: true,
                                visible: true,
                                className: "custom-confirm-btn",
                                closeModal: true
                            }
                        }
                }).then(() => {
                    window.location.href = 'login.html'
                });
                return;
            }
            if (!commentText.trim()) {
                swal({
                    title: "경고!",
                    text: "댓글의 내용을 입력하세요." ,
                    icon: "error",
                    buttons: {
                            confirm: {
                                text: "확인",
                                value: true,
                                visible: true,
                                className: "custom-confirm-btn",
                                closeModal: true
                            }
                        }
                });
                return;
            }
            const requestData = {
                comments: commentText,
            };

            fetchWithAuth(`http://49.247.174.32:8080/third-board/${postId}/third-board-comments/create`, {
            // fetchWithAuth(`http://localhost:8080/third-board/${postId}/third-board-comments/create`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(requestData)
            })
                .then(response => response.json())
                .then(data => {
                    swal({
                        title: "성공!",
                        text: "댓글이 성공적으로 작성되었습니다." ,
                        icon: "success",
                        buttons: {
                            confirm: {
                                text: "확인",
                                value: true,
                                visible: true,
                                className: "custom-confirm-btn",
                                closeModal: true
                            }
                        }
                    }).then(() => {
                        fetchComments();
                    });
                })
                .catch(error => {
                    swal({
                        title: "실패!",
                        text: "댓글 작성 중 오류가 발생했습니다 :" + error.message,
                        icon: "error",
                        buttons: {
                            confirm: {
                                text: "확인",
                                value: true,
                                visible: true,
                                className: "custom-confirm-btn",
                                closeModal: true
                            }
                        }
                    });
                });
        }

        // 댓글 수정 함수
        function editComment(commentId) {
            // 수정할 댓글을 찾기
            const commentElement = document.querySelector(`.comment4[data-comment-id="${commentId}"]`);

            if (!commentElement) {
                swal({
                    title: "실패!",
                    text: "댓글을 찾을 수 없습니다." ,
                    icon: "error",
                    buttons: {
                            confirm: {
                                text: "확인",
                                value: true,
                                visible: true,
                                className: "custom-confirm-btn",
                                closeModal: true
                            }
                        }
                });
                return;
            }

            const commentContentElement = commentElement.querySelector('.comment-content4');
            const currentContent = commentContentElement.textContent.trim();

            // 기존 댓글 내용을 input으로 변경
            commentContentElement.innerHTML = `
        <textarea class="edit-comment-input" style="width: 100%; height: 60px;">${currentContent}</textarea>
        <div class="edit-buttons">
            <button class="save-comment-btn">저장</button>
            <button class="cancel-comment-btn">취소</button>
        </div>
    `;

            // 저장 버튼 클릭 시 수정된 댓글 저장
            commentElement.querySelector('.save-comment-btn').addEventListener('click', function () {
                const newContent = commentElement.querySelector('.edit-comment-input').value;

                if (!newContent.trim()) {
                    swal({
                        title: "경고!",
                        text: "댓글 내용을 입력하세요." ,
                        icon: "warning",
                        buttons: {
                            confirm: {
                                text: "확인",
                                value: true,
                                visible: true,
                                className: "custom-confirm-btn",
                                closeModal: true
                            }
                        }
                    });
                    return;
                }

                // Fetch API를 통해 서버로 수정된 내용 전송
                fetchWithAuth(`http://49.247.174.32:8080/third-board/${postId}/third-board-comments/update/${commentId}`, {
                // fetchWithAuth(`http://localhost:8080/third-board/${postId}/third-board-comments/update/${commentId}`, {
                    method: 'PATCH',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ comments: newContent })
                })
                    .then(response => {
                        if (!response.ok) {
                            swal({
                                title: "실패!",
                                text: "서버 응답 오류. 다시한번 시도해 주세요." ,
                                icon: "error",
                                buttons: {
                            confirm: {
                                text: "확인",
                                value: true,
                                visible: true,
                                className: "custom-confirm-btn",
                                closeModal: true
                            }
                        }
                            });
                        }
                        return response.json(); // JSON 응답 처리
                    })
                    .then(data => {
                        if (data) {
                            swal({
                                title: "성공!",
                                text: "댓글이 성공적으로 수정되었습니다." ,
                                icon: "success",
                                buttons: {
                            confirm: {
                                text: "확인",
                                value: true,
                                visible: true,
                                className: "custom-confirm-btn",
                                closeModal: true
                            }
                        }
                            }).then(() => {
                                fetchComments();
                            });

                        } else {
                            swal({
                                title: "경고!",
                                text: "댓글에 대한 권한이 없습니다." ,
                                icon: "warning",
                                buttons: {
                            confirm: {
                                text: "확인",
                                value: true,
                                visible: true,
                                className: "custom-confirm-btn",
                                closeModal: true
                            }
                        }
                            });
                        }
                    })
                    .catch(error => {
                        swal({
                            title: "실패!",
                            text: "댓글 수정 중 오류가 발생했습니다 :" + error.message,
                            icon: "error",
                            buttons: {
                            confirm: {
                                text: "확인",
                                value: true,
                                visible: true,
                                className: "custom-confirm-btn",
                                closeModal: true
                            }
                        }
                        });
                    });
            });

            // 취소 버튼 클릭 시 수정 취소
            commentElement.querySelector('.cancel-comment-btn').addEventListener('click', function () {
                // 수정 전 원래 내용으로 복구
                commentContentElement.innerHTML = currentContent;
            });
        }

        // 댓글 삭제 함수
        function deleteComment(commentId) {
            swal({
                title: "댓글 삭제",
                text: "정말로 이 댓글을 삭제하시겠습니까?",
                icon: "warning",
                buttons: ["취소", "삭제"],
                dangerMode: true,
            })
                .then((willDelete) => {
                    if (willDelete) {
                        fetchWithAuth(`http://49.247.174.32:8080/third-board/${postId}/third-board-comments/delete/${commentId}`, {
                        // fetchWithAuth(`http://localhost:8080/third-board/${postId}/third-board-comments/delete/${commentId}`, {
                            method: 'DELETE'
                        })
                            .then(() => {
                                swal({
                                    title: "성공!",
                                    text: "댓글이 성공적으로 삭제되었습니다.",
                                    icon: "success",
                                    buttons: {
                            confirm: {
                                text: "확인",
                                value: true,
                                visible: true,
                                className: "custom-confirm-btn",
                                closeModal: true
                            }
                        }
                                }).then(() => {
                                    fetchComments(); // 댓글 삭제 후 댓글 목록 새로고침
                                });
                            })
                            .catch(error => {
                                swal({
                                    title: "경고!",
                                    text: "댓글에 대한 권한이 없습니다.",
                                    icon: "warning",
                                    buttons: {
                            confirm: {
                                text: "확인",
                                value: true,
                                visible: true,
                                className: "custom-confirm-btn",
                                closeModal: true
                            }
                        }
                                });
                            });
                    }
                });
        }
    });
</script>
</body>

</html>