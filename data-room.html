<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>한국 환경협회</title>
    <link rel="apple-touch-icon" sizes="180x180" href="assets/images/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/images/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/images/favicons/favicon-16x16.png">
    <link rel="manifest" href="assets/images/favicons/site.webmanifest">

    <!-- Fonts-->

    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/moonspam/NanumSquare@2.0/nanumsquare.css">
    <!-- Css-->
    <link rel="stylesheet" href="assets/css/animate.min.css">
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/owl.carousel.min.css">
    <link rel="stylesheet" href="assets/css/owl.theme.default.min.css">
    <link rel="stylesheet" href="assets/css/magnific-popup.css">
    <link rel="stylesheet" href="assets/css/fontawesome-all.min.css">
    <link rel="stylesheet" href="assets/css/swiper.min.css">
    <link rel="stylesheet" href="assets/css/bootstrap-select.min.css">

    <link rel="stylesheet" href="assets/css/jquery.mCustomScrollbar.min.css">
    <link rel="stylesheet" href="assets/css/bootstrap-datepicker.min.css">
    <link rel="stylesheet" href="assets/css/vegas.min.css">
    <link rel="stylesheet" href="assets/css/nouislider.min.css">
    <link rel="stylesheet" href="assets/css/nouislider.pips.css">
    <link rel="stylesheet" href="assets/css/jquery.bxslider.css">
    <link rel="stylesheet" href="assets/css/agrikol_iconl.css">
    <!-- Template styles -->
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/responsive.css">

</head>

<body>

<div class="preloader">
    <img src="assets/images/loader.png" class="preloader__image" alt="">
</div><!-- /.preloader -->

<div class="page-wrapper">


    <div class="site-header__header-one-wrap">

        <div class="topbar-one">
            <div class="topbar_bg" style="background-image: url(assets/images/shapes/header-bg.png)"></div>
            <div class="container">
                <div class="topbar-one__left">
                    <a href="tel:010-5850-8885"><span class="icon-phone-call"></span>010-5850-8885</a>
                    <a href="mailto:gislmh@naver.com"><span class="icon-message"></span>gislmh@naver.com</a>
                    <a ><span class="icon-clock"></span>9AM - 6PM</a>
                </div>

                <div class="topbar-one__right">
                    <div class="topbar-one__social">
                        <a href="#"><i class="fab fa-facebook-square"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-youtube"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
            </div>
        </div>

        <header class="main-nav__header-one">
            <nav class="header-navigation stricky">
                <div class="container clearfix">
                    <!-- Brand and toggle get grouped for better mobile display -->
                    <div class="main-nav__left">
                        <a href="index.html" class="main-nav__logo">
                            <img src="assets/images/resources/main-logo2.png" class="main-logo" alt="Awesome Image"/>
                        </a>

                    </div>
                    <div class="main-nav__main-navigation">
                        <ul class=" main-nav__navigation-box">
                            <li class="dropdown">
                                <a href="greeting.html">협회 소개</a>
                                <ul>
                                    <li><a href="greeting.html">인사말</a></li>
                                    <li><a href="license.html">설립허가 및 고유번호증</a></li>
                                    <li><a href="organization-chart.html">조직도</a></li>
                                    <li><a href="vision.html">협회비전</a></li>
                                    <li><a href="ci.html">협회 CI</a></li>

                                </ul><!-- /.sub-menu -->
                            </li>
                            <li class="dropdown">
                                <a href="environmental-program.html">협회 사업</a>
                                <ul>
                                    <li><a href="environmental-education.html">환경 교육 프로그램</a></li>
                                    <li><a href="environmental-program.html">환경 체험 프로그램</a></li>
                                    <li><a href="nature-restoration-project.html">풀빛 세상 만들기</a></li>
                                    <li><a href="csr-consulting.html">기업 사회 공헌 컨설팅</a></li>
                                </ul><!-- /.sub-menu -->
                            </li>
                            <li class="dropdown">
                                <a href="notice.html">커뮤니티</a>
                                <ul>
                                    <li><a href="notice.html">공지사항</a></li>
                                    <li><a href="free-board.html">자유게시판</a></li>
                                    <li><a href="gallery.html">사진갤러리</a></li>
                                </ul><!-- /.sub-menu -->
                            </li>
                            <li class="dropdown current">
                                <a href="data-room.html">자료실</a>
                                <ul>
                                    <li><a href="data-room.html">협회 자료</a></li>
                                </ul><!-- /.sub-menu -->
                            </li>
                            <li class="dropdown">
                                <a href="donation.html">후원 안내</a>
                                <ul>
                                    <li><a href="donation.html">후원신청</a></li>
                                </ul><!-- /.sub-menu -->
                            </li>
                            <li class="dropdown">
                                <a href="login.html">로그인</a>
                                <ul>
                                    <li><a href="sign-up.html">회원 가입</a></li>
                                    <li><a href="login.html">로그인</a></li>
                                    <li><a id="logout" href="">로그 아웃</a></li>
                                </ul><!-- /.sub-menu -->
                            </li>

                        </ul>
                    </div><!-- /.navbar-collapse -->

                    <div class="main-nav__right">

                    </div>
                </div>
            </nav>
        </header>
    </div>

    <section class="page-header" style="background-image: url(assets/images/resources/image3.jpg);">
        <div class="container">
            <p>21세기 친환경 한국을 향한 꿈</p>
            <h2>자료실</h2>

        </div>
    </section>

    <section class="best_company">
        <div class="container">
            <h2 id="introduction">협회 자료</h2>
            <div class="search-container4">
                <select id="search-type4">
                    <option value="all">전체</option>
                    <option value="title">제목</option>
                    <option value="content">내용</option>
                    <option value="name">작성자</option>
                </select>
                <input type="text" id="search-input4" placeholder="검색 내용을 입력하세요">
                <button id="search-button4">검색</button>
            </div>
            <div class="notice-table4">
                <table>
                    <thead>
                    <tr>
                        <th>번호</th>
                        <th>제목</th>
                        <th>작성자</th>
                        <th>작성일</th>
                        <th>추천</th>
                        <th>조회</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>5</td>
                        <td><a href="notice-details.html">인류의 공동목표인 환경보전 및 환경개선을 추구하는 모든 인류 및 단체와 연대하겠습니다.</a></td>
                        <td>admin</td>
                        <td>2024.04.05</td>
                        <td>0</td>
                        <td>8</td>
                    </tr>
                    <tr>
                        <td>4</td>
                        <td><a href="notice-details.html">쓰레기 및 오페물은 줄어가고, 자원은 다시 재활용하는 세상</a></td>
                        <td>admin</td>
                        <td>2024.04.05</td>
                        <td>0</td>
                        <td>2</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td><a href="notice-details.html">인류 환경가치의 중심 'GREEN BAND', 'GREEN HUMAN'</a></td>
                        <td>admin</td>
                        <td>2024.04.05</td>
                        <td>0</td>
                        <td>1</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td><a href="notice-details.html">사)한국환경협회는 환경의 가치(풀빛세상)을 알리는 소리입니다.</a></td>
                        <td>admin</td>
                        <td>2024.04.05</td>
                        <td>0</td>
                        <td>2</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td><a href="notice-details.html">인류의 환경문제를 해결하는 인류공동체의 Band를 만들겠습니다.</a></td>
                        <td>admin</td>
                        <td>2024.04.05</td>
                        <td>0</td>
                        <td>1</td>
                    </tr>
                    </tbody>
                </table>

                <div class="pagination4">
                    <ul>
                        <li class="active"><a id="notice_index" href="#">1</a></li>
                    </ul>
                </div>
                <div>
                    <a id="create-notice-button4" href="data-room-create.html">글쓰기</a>
                </div>
            </div>
        </div>
    </section>

    <div class="site-footer_bottom">
        <div class="container">
            <div class="site-footer_bottom_copyright">
                <p> <a href="donation.html">@ 한국 환경협회</a></p>
            </div>
            <div class="site-footer_bottom_copyright">
                <p> 고유번호 : 497-82-00350  </p>
            </div>
        </div>
    </div>


</div><!-- /.page-wrapper -->


<a href="#" data-target="html" class="scroll-to-target scroll-to-top"><i class="fa fa-angle-up"></i></a>


<script src="assets/js/jquery.min.js"></script>
<script src="assets/js/bootstrap.bundle.min.js"></script>
<script src="assets/js/owl.carousel.min.js"></script>
<script src="assets/js/waypoints.min.js"></script>
<script src="assets/js/jquery.counterup.min.js"></script>
<script src="assets/js/TweenMax.min.js"></script>
<script src="assets/js/wow.js"></script>
<script src="assets/js/jquery.magnific-popup.min.js"></script>
<script src="assets/js/jquery.ajaxchimp.min.js"></script>
<script src="assets/js/swiper.min.js"></script>
<script src="assets/js/typed-2.0.11.js"></script>
<script src="assets/js/vegas.min.js"></script>
<script src="assets/js/jquery.validate.min.js"></script>
<script src="assets/js/bootstrap-select.min.js"></script>
<script src="assets/js/countdown.min.js"></script>
<script src="assets/js/jquery.mCustomScrollbar.concat.min.js"></script>
<script src="assets/js/bootstrap-datepicker.min.js"></script>
<script src="assets/js/nouislider.min.js"></script>
<script src="assets/js/isotope.js"></script>
<script src="assets/js/jquery.bxslider.min.js"></script>
<script src="assets/js/appear.js"></script>

<!-- template scripts -->
<script src="assets/js/theme.js"></script>
<script src="assets/js/tokenManager.js"></script>
<script src="assets/js/logoutHandler.js"></script>
<script>

    document.addEventListener('DOMContentLoaded', function () {
        const postsContainer = document.querySelector('.notice-table4 tbody');
        const paginationContainer = document.querySelector('.pagination4 ul');
        const searchButton = document.getElementById('search-button4');
        const searchInput = document.getElementById('search-input4');
        const searchType = document.getElementById('search-type4');
        const searchResultsContainer = document.getElementById('search-results');

        let currentPage = 1;
        let postsPerPage = 5;
        let totalPages = 0;

        // 게시글 목록 조회 함수 (페이징 포함)
        function fetchAllPosts(page = 1) {
            const url = new URL('http://localhost:8080/third-board');
            url.searchParams.append('page', page - 1);
            url.searchParams.append('size', postsPerPage);

            fetch(url)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return response.json();
                })
                .then(data => {
                    totalPages = data.totalPages;
                    displayPosts(data.content);
                    setupPagination(totalPages, page);
                })
                .catch(error => {
                    console.error('게시글을 불러오는 중 오류가 발생했습니다:', error);
                    alert(error)
                });
        }

        // 게시글을 화면에 표시하는 함수
        function displayPosts(posts) {
            postsContainer.innerHTML = '';
            if (posts.length === 0) {
                postsContainer.innerHTML = '<tr><td colspan="6">게시글이 없습니다.</td></tr>';
                return;
            }

            posts.forEach((post, index) => {
                const postElement = document.createElement('tr');
                postElement.innerHTML = `
            <td>${((currentPage - 1) * postsPerPage) + (index + 1)}</td>
            <td><a href="#" data-id="${post.id}" class="view-post-link">${post.title}</a></td>
            <td>${post.name}</td>
            <td>${new Date(post.createdAt).toLocaleDateString()}</td>
            <td>${post.likeCount}</td>
            <td>${post.viewCount}</td>
        `;
                postsContainer.appendChild(postElement);
            });

            // 게시글 클릭 시 상세 페이지로 이동 처리
            document.querySelectorAll('.view-post-link').forEach(link => {
                link.addEventListener('click', function (e) {
                    e.preventDefault();
                    const postId = this.getAttribute('data-id');
                    if (postId) {
                        localStorage.setItem('currentPostId', postId);
                        window.location.href = 'data-room-details.html';
                    } else {
                        console.error('게시글 ID를 가져오지 못했습니다.');
                    }
                });
            });
        }

        // 검색 버튼 클릭 이벤트 처리
        searchButton.addEventListener('click', function (e) {
            e.preventDefault();
            const query = searchInput.value.trim();
            const searchBy = searchType.value;

            if (!query) {
                alert('검색어를 입력하세요');
                return;
            }

            // 검색 요청 보내기
            fetchSearchResults(query, searchBy, currentPage);
        });

        // 검색 요청 함수
        function fetchSearchResults(query, searchBy, page = 1) {
            const url = new URL('http://localhost:8080/third-board/search');
            url.searchParams.append('query', query);
            url.searchParams.append('searchBy', searchBy);
            url.searchParams.append('page', page - 1);
            url.searchParams.append('size', postsPerPage);

            fetch(url)
                .then(response => response.json())
                .then(data => {
                    displayPosts(data.content);
                    totalPages = data.totalPages;
                    setupPagination(totalPages, page, query, searchBy);
                })
                .catch(error => {
                    console.error('검색 요청 중 오류가 발생했습니다:', error);
                });
        }

        // 페이징 버튼을 생성하는 함수
        function setupPagination(totalPages, currentPage) {
            paginationContainer.innerHTML = '';

            for (let i = 1; i <= totalPages; i++) {
                const pageItem = document.createElement('li');
                pageItem.innerHTML = `<a href="#">${i}</a>`;
                if (i === currentPage) {
                    pageItem.classList.add('active');
                }
                pageItem.addEventListener('click', function (e) {
                    e.preventDefault();
                    fetchAllPosts(i);
                });
                paginationContainer.appendChild(pageItem);
            }
        }


        fetchAllPosts();
    });
</script>
</body>

</html>